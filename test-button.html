<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test BotÃ³n Confirmar Reserva</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            display: inline-block;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border-color: #059669;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(5, 150, 105, 0.3);
        }
        
        /* ðŸ”¥ MISMO CSS QUE EN LA APP REAL */
        #confirmReservation {
            pointer-events: auto !important;
            cursor: pointer !important;
            z-index: 9999 !important;
            position: relative !important;
        }
        
        .log {
            background: #1f2937;
            color: #10b981;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .info { color: #3b82f6; }
    </style>
</head>
<body>
    <h1>ðŸ”¥ Test BotÃ³n Confirmar Reserva</h1>
    <p><strong>Esta pÃ¡gina simula exactamente el mismo botÃ³n que tienes en la aplicaciÃ³n real.</strong></p>
    
    <div>
        <h3>MÃ©todo 1: onclick HTML (PRINCIPAL)</h3>
        <button id="confirmReservation" class="btn btn-success" onclick="window.executeReservation()">
            <i class="fas fa-check"></i>
            Confirmar Reserva (Test)
        </button>
    </div>
    
    <div>
        <h3>MÃ©todo 2: Event Listener JavaScript</h3>
        <button id="testBtn2" class="btn btn-success">
            Event Listener Test
        </button>
    </div>
    
    <div>
        <h3>MÃ©todo 3: FunciÃ³n Directa</h3>
        <button class="btn btn-success" onclick="directTest()">
            FunciÃ³n Directa Test
        </button>
    </div>
    
    <div>
        <h3>Log de Funcionamiento:</h3>
        <div id="log" class="log">Esperando clicks...\n</div>
    </div>
    
    <div>
        <h3>Comandos de Consola:</h3>
        <p>Abre la consola (F12) y ejecuta:</p>
        <code>
            â€¢ executeReservation() - Simular reserva<br>
            â€¢ debugButton() - Ver estado del botÃ³n<br>
            â€¢ testAllMethods() - Probar todos los mÃ©todos
        </code>
    </div>

    <script>
        // FunciÃ³n para logging
        function log(message, type = 'info') {
            const logEl = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : (type === 'success' ? 'success' : 'info');
            logEl.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            logEl.scrollTop = logEl.scrollHeight;
            console.log(`[${timestamp}] ${message}`);
        }
        
        // ðŸ”¥ MISMA FUNCIÃ“N QUE EN LA APP REAL
        window.executeReservation = function() {
            log('ðŸ”¥ FUNCIÃ“N GLOBAL EJECUTADA desde onclick HTML', 'success');
            try {
                // Simular handleConfirmReservation
                simulateReservation();
            } catch (error) {
                log('âŒ Error ejecutando reserva: ' + error.message, 'error');
                alert('Error al procesar la reserva. Por favor, revise los datos e intente nuevamente.');
            }
        };
        
        // Simular la funciÃ³n de reserva
        function simulateReservation() {
            log('ðŸŽ¯ INICIANDO RESERVA UNIVERSAL SINCRONIZADA', 'info');
            log('âœ… BOTÃ“N CONFIRMRESERVATION FUNCIONANDO - Event listener conectado correctamente', 'success');
            
            // Simular datos de reserva
            const selectedDate = new Date('2025-07-20');
            const isVerified = true;
            const reservationData = {
                name: 'Usuario Test',
                phone: '+34999888777',
                carBrand: 'Test',
                carModel: 'Vehicle',
                carSize: 'medium',
                services: ['interior'],
                price: 25
            };
            
            if (!selectedDate || !isVerified) {
                log('âŒ VALIDACIÃ“N FALLIDA: selectedDate=' + selectedDate + ', isVerified=' + isVerified, 'error');
                return;
            }
            
            log('âœ… VALIDACIONES PASADAS, continuando con reserva...', 'success');
            log('ðŸ“Š DATOS ESTADO: ' + JSON.stringify({
                selectedDate: selectedDate.toDateString(),
                isVerified,
                reservationData: reservationData
            }), 'info');
            
            // Simular Ã©xito
            setTimeout(() => {
                log('âœ… Reserva confirmada en servidor (SIMULADO)', 'success');
                log('ðŸ“± ConfirmaciÃ³n WhatsApp enviada automÃ¡ticamente (SIMULADO)', 'success');
                alert('ðŸŽ‰ Â¡Reserva confirmada exitosamente! (Test)');
            }, 1000);
        }
        
        // FunciÃ³n directa de test
        function directTest() {
            log('ðŸ§ª FUNCIÃ“N DIRECTA EJECUTADA', 'info');
            simulateReservation();
        }
        
        // ðŸ”§ FUNCIÃ“N SIMPLE DE DEBUG (MISMA QUE EN LA APP)
        window.debugButton = function() {
            const btn = document.getElementById('confirmReservation');
            const debug = {
                exists: !!btn,
                disabled: btn?.disabled,
                onclick: btn?.getAttribute('onclick'),
                visible: btn ? window.getComputedStyle(btn).display !== 'none' : false,
                pointerEvents: btn ? window.getComputedStyle(btn).pointerEvents : 'N/A',
                zIndex: btn ? window.getComputedStyle(btn).zIndex : 'N/A'
            };
            log('ðŸ” DEBUG BOTÃ“N: ' + JSON.stringify(debug, null, 2), 'info');
            console.log('ðŸ” DEBUG BOTÃ“N:', debug);
            return btn;
        };
        
        // Test de todos los mÃ©todos
        window.testAllMethods = function() {
            log('ðŸ§ª PROBANDO TODOS LOS MÃ‰TODOS...', 'info');
            
            // Test 1: onclick
            log('Test 1: onclick HTML', 'info');
            try {
                executeReservation();
                log('âœ… Test 1 EXITOSO', 'success');
            } catch (e) {
                log('âŒ Test 1 FALLIDO: ' + e.message, 'error');
            }
            
            // Test 2: event listener
            setTimeout(() => {
                log('Test 2: Event Listener', 'info');
                try {
                    const btn2 = document.getElementById('testBtn2');
                    btn2.click();
                    log('âœ… Test 2 EXITOSO', 'success');
                } catch (e) {
                    log('âŒ Test 2 FALLIDO: ' + e.message, 'error');
                }
            }, 500);
            
            // Test 3: Debug
            setTimeout(() => {
                log('Test 3: Debug Button', 'info');
                debugButton();
                log('âœ… Test 3 COMPLETADO', 'success');
            }, 1000);
        };
        
        // Configurar event listener para el segundo botÃ³n
        document.addEventListener('DOMContentLoaded', function() {
            log('ðŸš€ PÃ¡gina cargada - Configurando event listeners...', 'info');
            
            const btn2 = document.getElementById('testBtn2');
            if (btn2) {
                btn2.addEventListener('click', function(e) {
                    e.preventDefault();
                    log('ðŸ”¥ CLICK DETECTADO EN BOTÃ“N - Ejecutando reserva...', 'success');
                    simulateReservation();
                });
                log('âœ… Event listener configurado para testBtn2', 'success');
            }
            
            log('âœ… InicializaciÃ³n completa', 'success');
            log('ðŸ’¡ Haz clic en cualquier botÃ³n para probar o usa los comandos de consola', 'info');
        });
        
        console.log('ðŸ”¥ TEST PAGE CARGADA');
        console.log('ðŸ”¥ FUNCIONES DISPONIBLES:');
        console.log('   â€¢ executeReservation() - Ejecutar reserva desde onclick');
        console.log('   â€¢ debugButton() - Ver estado del botÃ³n');
        console.log('   â€¢ testAllMethods() - Probar todos los mÃ©todos');
    </script>
</body>
</html> 